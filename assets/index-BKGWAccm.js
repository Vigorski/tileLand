(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();function N(a,t){let e;return function(...s){clearTimeout(e),e=setTimeout(()=>{a(...s)},t)}}function m(a,t,e){return a*Math.pow(1-t,e)}function I(a){return Math.round((a+Number.EPSILON)*100)/100}class F{constructor(t){this.startTime=0,this.prevTime=performance.now(),this.frames=0,this.onUpdate=t||(e=>console.log(`FPS: ${e}`))}begin(){this.startTime=performance.now()}end(){const t=performance.now();if(this.frames++,t>=this.prevTime+1e3){const e=Math.round(this.frames*1e3/(t-this.prevTime));this.onUpdate(e),this.prevTime=t,this.frames=0}}}const g=!0,E=4,w=1,S=.4,y=.1,T=.6,G=[67,62,66],V=[73,73,73],X=[104,37,184],Y=[13,232,131],L=.25,_=.6,B=.5,C="svg",f="canvas",P=25,z=.1,H=.15;class ${constructor(t,e={}){const{tilePixelSize:s=P,tileWidth:i=1,hoverEngaged:o=g,hoverRadius:n=E,scaleExpDecay:c=S,pushoffExpInitial:h=y,pushoffExpDecay:l=T,monitor:d=null}=e;this.monitor=d,this.svg="http://www.w3.org/2000/svg",this.container=t,this.tilePixelSize=s,this.columns=this.getColumns(),this.rows=this.getRows(),this.tileState=new Array,this.tileWidth=i??1,this.tileOffset=this.tileWidth/2,this.tileStrokeWidth=this.tileWidth/this.columns,this.baseSVG=this.createBaseSVG(),this.allTiles=this.baseSVG.querySelectorAll(".cascade-waves__tile"),this.boardXCenter=Math.floor(this.columns/2),this.boardYCenter=Math.floor(this.rows/2),this.isPaused=!1,this.animationFrameId=null,this.waveIncrement=B,this.activeWaves=[],this.hoverEngaged=o,this.hoverRadius=n,this.colorGray=G,this.colorThreshold=X,this.colorInitial=L,this.colorDecay=_,this.pushoffExpInitial=h,this.pushoffExpDecay=l,this.scaleExpInitial=w,this.scaleExpDecay=c,this.addHoverEvent(),this.loop()}getColumns(){const t=this.container.offsetWidth;return Math.round(t/this.tilePixelSize)}getRows(){const t=this.container.offsetHeight;return Math.round(t/this.tilePixelSize)}createBaseSVG(){const t=document.createElementNS(this.svg,"svg");t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("viewBox",`-${this.tileOffset} -${this.tileOffset} ${this.columns} ${this.rows}`),t.setAttribute("class","cascade-waves");const e=document.createElementNS(this.svg,"g");e.setAttribute("class","cascade-waves__root-grid");const s=document.createElementNS(this.svg,"g");s.setAttribute("class","cascade-waves__tiles");for(let i=0;i<this.rows;i++)for(let o=0;o<this.columns;o++)e.appendChild(this.createRootTile(o,i)),s.appendChild(this.createTile(o,i));return t.appendChild(s),t.appendChild(e),this.container.appendChild(t),t.addEventListener("click",i=>{if(i.target.classList.contains("cascade-waves__root-tile")){const[o,n]=i.target.dataset.pos.split(",").map(Number),c={x:o,y:n};this.incrementWaveRadius(c)}}),t}createTile(t,e){const s=document.createElementNS(this.svg,"g");s.setAttributeNS(null,"transform",`translate(${t}, ${e})`),s.setAttribute("class","cascade-waves__tile");const i=document.createElementNS(this.svg,"rect");return i.setAttributeNS(null,"width",this.tileWidth),i.setAttributeNS(null,"height",this.tileWidth),i.setAttributeNS(null,"x",-this.tileOffset),i.setAttributeNS(null,"y",-this.tileOffset),i.setAttributeNS(null,"stroke-width",this.tileStrokeWidth),s.appendChild(i),this.setTileState(t,e,i),s}createRootTile(t,e){const s=document.createElementNS(this.svg,"rect");return s.setAttributeNS(null,"x",t),s.setAttributeNS(null,"y",e),s.setAttributeNS(null,"width",this.tileWidth),s.setAttributeNS(null,"height",this.tileWidth),s.setAttributeNS(null,"transform",`translate(${-this.tileOffset}, ${-this.tileOffset})`),s.setAttribute("class","cascade-waves__root-tile"),s.dataset.pos=[t,e],s}loop(){this.isPaused||(this.monitor&&this.monitor.begin(),this.drawWavesAction(),this.monitor&&this.monitor.end(),this.animationFrameId=requestAnimationFrame(()=>this.loop()))}pause(){this.baseSVG&&(this.baseSVG.style.display="none"),this.isPaused=!0,this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}resume(){this.baseSVG&&(this.baseSVG.style.display="block"),this.isPaused=!1,this.loop()}destroyBoard(){this.pause(),this.baseSVG&&(this.container.removeChild(this.baseSVG),this.baseSVG=null)}resetBoard(){this.destroyBoard(),this.columns=this.getColumns(),this.rows=this.getRows(),this.boardXCenter=Math.floor(this.columns/2),this.boardYCenter=Math.floor(this.rows/2),this.baseSVG=this.createBaseSVG(),this.hoverEngaged=g,this.addHoverEvent(),this.hoverRadius=E,this.pushoffExpInitial=y,this.pushoffExpDecay=T,this.scaleExpDecay=S,this.scaleExpInitial=w,this.isPaused=!1,this.loop()}returnTilesToDefault(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++){const s=this.tileState[t]?.[e];s&&(s.hovered=!1,s.element.style.transform="scale(1)",s.element.style.fill="#433e42")}}incrementWaveRadius(t){this.activeWaves.push({origin:t,radius:0})}drawWavesAction(){if(this.activeWaves.length===0)return;this.activeWaves.forEach(e=>{e.radius+=this.waveIncrement,this.loopThroughTiles(e.origin,e.radius)});const t=this.columns+this.boardXCenter;this.activeWaves=this.activeWaves.filter(e=>e.radius<t)}loopThroughTiles(t,e){const s=Math.cos(this.toRadians(45)),i=Math.floor(e*s);for(let o=0;o<=i;o++){const n=Math.floor(Math.sqrt(e*e-o*o));this.activateTile(t.y+o,t.x-n),this.activateTile(t.y+o,t.x+n),this.activateTile(t.y-o,t.x-n),this.activateTile(t.y-o,t.x+n),this.activateTile(t.y+n,t.x-o),this.activateTile(t.y+n,t.x+o),this.activateTile(t.y-n,t.x-o),this.activateTile(t.y-n,t.x+o)}}activateTile(t,e){this.tileState[t]&&this.tileState[t][e]&&(this.tileState[t][e].element.classList.add("cascade-waves__tile--active"),this.tileState[t][e].element.addEventListener("animationend",s=>{setTimeout(()=>{s.target.classList.remove("cascade-waves__tile--active")},0)},{once:!0}))}addHoverEvent(){this.baseSVG.addEventListener("mousemove",t=>{if(!this.hoverEngaged)return;const e=this.baseSVG.getBoundingClientRect(),s=Math.floor(e.left),i=Math.floor(e.top),o=e.width/this.columns,n=e.height/this.rows,c=(t.clientX-s)/o,h=(t.clientY-i)/n,l={x:c-this.tileWidth/2,y:h-this.tileWidth/2};this.tileDislocate(l)})}tileDislocate(t){if(!t)return;const e={x:t.x,y:t.y};for(let s=0;s<=this.rows;s++)for(let i=0;i<=this.columns;i++){const o=this.tileState[s]?.[i];if(!o)continue;const n={x:i,y:s},c=o.element;if(this.insideRadius(e,n,this.hoverRadius)){const h=i-e.x,l=s-e.y,d=Math.sqrt(h*h+l*l),v=I(m(this.scaleExpInitial,this.scaleExpDecay,this.hoverRadius-d)),p=I(m(this.pushoffExpInitial,this.pushoffExpDecay,d-this.hoverRadius)),u=I(m(this.colorInitial,this.colorDecay,d-this.hoverRadius)),b=[Math.round(this.colorGray[0]+this.colorThreshold[0]*u),Math.round(this.colorGray[1]-this.colorThreshold[1]*u),Math.round(this.colorGray[2]+this.colorThreshold[2]*u)];this.tileState[s][i].hovered=!0,c.style.transform=`translate(${h*p}px, ${l*p}px) scale(${v})`,c.style.fill=`rgb(${b[0]}, ${b[1]}, ${b[2]})`}else this.tileState[s][i].hovered&&(this.tileState[s][i].hovered=!1,c.style.transform="scale(1)",c.style.fill="#433e42")}}activateHoverInCenter(){const t={x:this.boardXCenter,y:this.boardYCenter};this.tileDislocate(t)}setTileState(t,e,s){this.tileState[e]||(this.tileState[e]=new Array),this.tileState[e][t]={x:t,y:e,element:s,hovered:!1}}insideRadius(t,e,s){const i=t.x-e.x,o=t.y-e.y;return Math.sqrt(i*i+o*o)<=s}toRadians(t){return t*(Math.PI/180)}}class k{constructor(t,e={}){const{tilePixelSize:s=P,hoverEngaged:i=g,hoverRadius:o=E,scaleExpDecay:n=S,pushoffExpInitial:c=y,pushoffExpDecay:h=T,colorInactive:l=V,colorFocus:d=Y,monitor:v=null}=e;this.monitor=v,this.isPaused=!1,this.animationFrameId=null,this.container=t,this.tilePixelSize=s,this.tileOffset=.5,this.hoverEngaged=i,this.hoverRadius=o,this.waveIncrement=B,this.activeTileLerpRate=z,this.returningTileLerpRate=H,this.scaleExpInitial=w,this.scaleExpDecay=n,this.pushoffExpInitial=c,this.pushoffExpDecay=h,this.colorInactive=l,this.colorFocus=d,this.colorInitial=L,this.colorDecay=_,this.columns=this.getColumns(),this.rows=this.getRows(),this.flatTiles=[],this.baseTiles=[],this.pushedTiles=[],this.boardXCenter=Math.floor(this.columns/2),this.boardYCenter=Math.floor(this.rows/2),this.tileState=[],this.activeWaves=[],this.mouseCoordinates={mouseX:0,mouseY:0},this.createCanvas(),this.generateTiles(),this.flattenTiles(),this.addHoverEvent(),this.draw()}getColumns(){const t=document.getElementById("boardWrapper").offsetWidth;return Math.round(t/this.tilePixelSize)}getRows(){const t=document.getElementById("boardWrapper").offsetHeight;return Math.round(t/this.tilePixelSize)}createCanvas(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.columns*this.tilePixelSize,this.canvas.height=this.rows*this.tilePixelSize,this.container.appendChild(this.canvas),this.canvas.addEventListener("click",()=>{const t={x:Math.floor(this.mouseCoordinates.mouseX),y:Math.floor(this.mouseCoordinates.mouseY)};this.incrementWaveRadius(t)})}generateTiles(){for(let t=0;t<this.rows;t++){this.tileState[t]=[];for(let e=0;e<this.columns;e++)this.tileState[t][e]={x:e,y:t,hovered:!1,targetOffsetX:0,targetOffsetY:0,currentOffsetX:0,currentOffsetY:0,baseCenterX:e*this.tilePixelSize+this.tilePixelSize/2,baseCenterY:t*this.tilePixelSize+this.tilePixelSize/2,targetScale:1,currentScale:1,color:[...this.colorInactive],waveActive:!1,waveTTL:0}}}flattenTiles(){const t=this.columns*this.rows;this.flatTiles=new Array(t),this.baseTiles.length=0,this.pushedTiles.length=0;let e=0;for(let s=0;s<this.rows;s++)for(let i=0;i<this.columns;i++)this.flatTiles[e++]=this.tileState[s][i]}setMouseCanvasCoordinates(t){const e=this.canvas.getBoundingClientRect(),s=(t.clientX-e.left)/this.tilePixelSize,i=(t.clientY-e.top)/this.tilePixelSize;this.mouseCoordinates.mouseX=s,this.mouseCoordinates.mouseY=i}addHoverEvent(){this.canvas.addEventListener("mousemove",t=>{this.setMouseCanvasCoordinates(t),this.hoverEngaged&&this.tileDislocate({x:this.mouseCoordinates.mouseX-this.tileOffset,y:this.mouseCoordinates.mouseY-this.tileOffset})})}tileDislocate(t){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++){const i=this.tileState[e][s],o=s-t.x,n=e-t.y,c=Math.sqrt(o*o+n*n);if(c<=this.hoverRadius){const h=m(this.scaleExpInitial,this.scaleExpDecay,this.hoverRadius-c),l=m(this.pushoffExpInitial,this.pushoffExpDecay,c-this.hoverRadius),d=m(this.colorInitial,this.colorDecay,c-this.hoverRadius);i.hovered=!0,i.targetOffsetX=o*l*this.tilePixelSize,i.targetOffsetY=n*l*this.tilePixelSize,i.targetScale=h,i.color=[Math.round(this.colorInactive[0]+this.colorFocus[0]*d),Math.round(this.colorInactive[1]+this.colorFocus[1]*d),Math.round(this.colorInactive[2]+this.colorFocus[2]*d)]}else i.hovered&&(i.hovered=!1,i.targetScale=1,i.targetOffsetX=0,i.targetOffsetY=0,i.color=[...this.colorInactive])}}incrementWaveRadius(t){this.activeWaves.push({origin:t,radius:0})}loopThroughTiles(t,e){const s=Math.cos(Math.PI/4),i=Math.floor(e*s);for(let o=0;o<=i;o++){const n=Math.floor(Math.sqrt(e*e-o*o));this.activateTile(o,-n,t),this.activateTile(o,n,t),this.activateTile(-o,-n,t),this.activateTile(-o,n,t),this.activateTile(n,-o,t),this.activateTile(n,o,t),this.activateTile(-n,-o,t),this.activateTile(-n,o,t)}}activateTile(t,e,s){const i=s.x+e,o=s.y+t,n=this.tileState[o]&&this.tileState[o][i];n&&(n.targetScale=0,n.color=this.colorFocus,n.waveActive=!0,n.waveTTL=8)}activateHoverInCenter(){const t={x:this.boardXCenter,y:this.boardYCenter};this.tileDislocate(t)}resetBoard(){this.tileState=[],this.columns=this.getColumns(),this.rows=this.getRows(),this.canvas.width=this.columns*this.tilePixelSize,this.canvas.height=this.rows*this.tilePixelSize,this.hoverEngaged=g,this.hoverRadius=E,this.pushoffExpInitial=y,this.pushoffExpDecay=T,this.scaleExpDecay=S,this.generateTiles(),this.flattenTiles()}returnTilesToDefault(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++){const s=this.tileState[t][e];s.hovered=!1,s.targetOffsetX=0,s.targetOffsetY=0,s.targetScale=1,s.color=[...this.colorInactive]}}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.canvas.style.display="none",this.isPaused=!0}resume(){this.canvas.style.display="block",this.isPaused=!1,this.draw()}destroyBoard(){this.pause(),this.canvas.replaceWith(this.canvas.cloneNode(!0)),this.canvas.remove()}drawTile(t){const s=t.targetOffsetX===0&&t.targetOffsetY===0?this.returningTileLerpRate:this.activeTileLerpRate;t.waveActive&&(t.waveTTL-=1,t.waveTTL<=0&&(t.waveActive=!1,t.targetScale=1,t.color=[...this.colorInactive])),t.currentOffsetX+=(t.targetOffsetX-t.currentOffsetX)*s,t.currentOffsetY+=(t.targetOffsetY-t.currentOffsetY)*s,t.currentScale+=(t.targetScale-t.currentScale)*s;const i=t.baseCenterX+t.currentOffsetX,o=t.baseCenterY+t.currentOffsetY,n=this.tilePixelSize*t.currentScale/2,c=i-n,h=o-n,l=n*2,[d,v,p]=t.color;this.ctx.fillStyle=`rgb(${d}, ${v}, ${p})`,this.ctx.fillRect(c,h,l,l);const u=1;this.ctx.fillStyle=`rgb(${d-40}, ${v-40}, ${p-40})`,this.ctx.fillRect(c,h,l,u),this.ctx.fillRect(c,h+l-u,l,u),this.ctx.fillRect(c,h,u,l),this.ctx.fillRect(c+l-u,h,u,l)}drawWavesAction(){this.activeWaves.forEach(t=>{t.radius+=this.waveIncrement,this.loopThroughTiles(t.origin,t.radius)}),this.activeWaves=this.activeWaves.filter(t=>t.radius<this.columns+this.boardXCenter)}drawHoverAction(){this.baseTiles.length=0,this.pushedTiles.length=0;for(let t=0;t<this.flatTiles.length;t++){const e=this.flatTiles[t];e.targetOffsetX+e.targetOffsetY!==0||e.waveActive?this.pushedTiles.push(e):this.baseTiles.push(e)}this.baseTiles.forEach(t=>this.drawTile(t)),this.pushedTiles.forEach(t=>this.drawTile(t))}draw(){this.monitor&&this.monitor.begin(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawWavesAction(),this.drawHoverAction(),this.monitor&&this.monitor.end(),this.animationFrameId=requestAnimationFrame(()=>this.draw())}}const q=new F(a=>{document.getElementById("fpsCounter").textContent=a}),R={hoverEngaged:g,hoverRadius:E,pushoffExpInitial:y,pushoffExpDecay:T,scaleExpDecay:S},r={boardCache:{[f]:null,[C]:null},configCache:{[f]:{...R},[C]:{...R}},currentBoardType:f,currentBoard:null,boardControls:null,controlsInitialized:!1};function D(a,t){r.configCache[r.currentBoardType][a]=t,r.currentBoard&&(r.currentBoard[a]=t)}function A(a,t,e){const i=typeof e<"u"?e:a.checked;D("hoverEngaged",i),i||r.currentBoard.returnTilesToDefault(),typeof e>"u"&&i&&r.currentBoard.activateHoverInCenter()}function x(a,t,e){const s=a.nextElementSibling,i=typeof e<"u",o=i?e:Number(a.value);i&&(a.value=o),D(t,o),s.innerText=o}function U(){const a=N(()=>{r.currentBoard&&r.currentBoard.resetBoard()},250);window.addEventListener("resize",a)}function K(){const a=document.querySelector(".controls"),t=document.getElementById("controlsOpen"),e=document.getElementById("controlsClose");t.addEventListener("click",()=>{a.classList.remove("controls--hidden")}),e.addEventListener("click",()=>{a.classList.add("controls--hidden")})}function W(a){const t=r.configCache[a];r.boardControls.forEach(e=>{const s=t[e.property];e.handler===A?(e.ele.checked=s,e.handler(e.ele,null,s)):e.handler(e.ele,e.property,s)})}function Z(){document.getElementById("reset").addEventListener("click",()=>{r.configCache[r.currentBoardType]={...R},W(r.currentBoardType),r.currentBoard.resetBoard()})}function j(){if(r.controlsInitialized)return;const a=document.getElementById("engageHover"),t=document.getElementById("hoverRadius"),e=document.getElementById("dislocateStart"),s=document.getElementById("dislocateDecay"),i=document.getElementById("tileSizeDecay");r.boardControls=[{ele:a,property:"hoverEngaged",handler:A,event:"change"},{ele:t,property:"hoverRadius",handler:x,event:"input"},{ele:e,property:"pushoffExpInitial",handler:x,event:"input"},{ele:s,property:"pushoffExpDecay",handler:x,event:"input"},{ele:i,property:"scaleExpDecay",handler:x,event:"input"}],r.boardControls.forEach(o=>{o.ele.addEventListener(o.event,n=>{o.handler(n.target,o.property),o.property!=="hoverEngaged"&&(a.checked||(a.checked=!0,A(a,null,!0)))})}),K(),Z(),U(),r.controlsInitialized=!0}function O(a=f){const t=a===f?C:f;if(r.boardCache[t]&&r.boardCache[t].pause(),r.currentBoardType=a,r.boardCache[a])r.boardCache[a].isPaused&&r.boardCache[a].resume();else{const e=document.getElementById("boardWrapper"),s=a===f?k:$,i=r.configCache[a];r.boardCache[a]=new s(e,{...i,monitor:q})}r.currentBoard=r.boardCache[a],r.currentBoard.resetBoard(),W(a),document.body.setAttribute("data-board-type",a)}const J=document.getElementById("btnSwitchGroup"),Q=document.getElementById("loadSVG"),tt=document.getElementById("loadCanvas");async function et(){j(),O(f)}function M(a){J.querySelector(".btn-switch--active").classList.remove("btn-switch--active"),a.classList.add("btn-switch--active")}tt.addEventListener("click",a=>{M(a.target),O(f)});Q.addEventListener("click",a=>{M(a.target),O(C)});et();
